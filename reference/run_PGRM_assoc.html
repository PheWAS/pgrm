<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="(NOTE: If you used principle components as covariates, make sure they are not coded as numeric.
Otherwise the logistic regression will treat them as categorical variables, making the function
run very slowly before failing.)"><title>Run associations in the pgrm on data from a test cohort. Function requires row level phenotype,
genotype, and covariate information. — run_PGRM_assoc • pgrm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run associations in the pgrm on data from a test cohort. Function requires row level phenotype,
genotype, and covariate information. — run_PGRM_assoc"><meta property="og:description" content="(NOTE: If you used principle components as covariates, make sure they are not coded as numeric.
Otherwise the logistic regression will treat them as categorical variables, making the function
run very slowly before failing.)"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pgrm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/my-vignette.html">Running the PGRM on summary statistics</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/hugheylab/pgrm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Run associations in the pgrm on data from a test cohort. Function requires row level phenotype,
genotype, and covariate information.</h1>
      <small class="dont-index">Source: <a href="https://github.com/hugheylab/pgrm/blob/HEAD/R/pgrm.R" class="external-link"><code>R/pgrm.R</code></a></small>
      <div class="d-none name"><code>run_PGRM_assoc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>(NOTE: If you used principle components as covariates, make sure they are not coded as numeric.
Otherwise the logistic regression will treat them as categorical variables, making the function
run very slowly before failing.)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_PGRM_assoc</span><span class="op">(</span></span>
<span>  <span class="va">geno</span>,</span>
<span>  <span class="va">pheno</span>,</span>
<span>  <span class="va">covars</span>,</span>
<span>  <span class="va">covariate_names</span>,</span>
<span>  <span class="va">PGRM</span>,</span>
<span>  MCC <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  minimum_case_count <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  use_exclude_ranges <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  check_sex <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  LOUD <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>geno</dt>
<dd><p>A matrix or 'BEDMatrix' object containing genetic data</p></dd>


<dt>pheno</dt>
<dd><p>A data.table with phecode phenotypes. columns <code>person_id</code>, <code>phecode</code>, and <code>N</code>
required. The phecode columns should be a character vector. Column <code>N</code> specifies the number of
unique dates a phecode occurs for that individual. Only phecodes that are present for an individual
are included (i.e. N is always greater than one).</p></dd>


<dt>covars</dt>
<dd><p>A data.table having one row per person in the cohort. Must havea column names
<code>person_id</code>. Must include other columns specified in covariate_names.</p></dd>


<dt>covariate_names</dt>
<dd><p>A list of covariates to be used in the logistic regression. All covariates
listed must be present in the covars table</p></dd>


<dt>PGRM</dt>
<dd><p>A data.table of the PGRM, generated with get_PGRM()</p></dd>


<dt>MCC</dt>
<dd><p>An integer specifying the minimum code count required for a case (default MCC=2)</p></dd>


<dt>minimum_case_count</dt>
<dd><p>An integer specifiying the minimum number of cases required in the test
cohort to be included in the analysis (default minimum_case_count=100)</p></dd>


<dt>use_exclude_ranges</dt>
<dd><p>If TRUE then exclude ranges are applied to controls</p></dd>


<dt>check_sex</dt>
<dd><p>If TRUE then individuals with sex == F in the covars table will be excluded
from male-specific phenotypes, and vice-versa. Sex specific phecodes are specified in
phecode_info. For this function to work, the covars table must have column <code>sex</code> and the values
must be 'M' for Male and 'F' for Female</p></dd>


<dt>LOUD</dt>
<dd><p>If TRUE then progress info is printed to the terminal. Default TRUE</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A data.table with annotated results from association tests</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pgrm.hugheylab.org">pgrm</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## Read in an ICD file. Format should look like the example file.</span></span></span>
<span class="r-in"><span>  <span class="co">## Note: Don't forget to load icd column as a character vector!</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">icdExampleTable</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    person_id    icd flag entry_date</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:         1  034.0    9 2014-04-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:         3  041.9    9 2014-08-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:         1 079.99    9 2011-05-30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:         3  112.1    9 2014-08-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:         2  150.5    9 2014-02-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:         2  150.5    9 2014-04-18</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## make pheno table</span></span></span>
<span class="r-in"><span>  <span class="va">pheno</span> <span class="op">=</span> <span class="fu"><a href="make_pheno.html">make_pheno</a></span><span class="op">(</span><span class="va">icdExampleTable</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pheno</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    person_id phecode N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:         1     465 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:         3     041 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:         1     079 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:         3     112 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:         2     150 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:         2     151 6</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## Load in covariate file. Here's a generated example</span></span></span>
<span class="r-in"><span>  <span class="va">covar_table_test</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  person_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'F'</span>, <span class="st">'M'</span>, <span class="st">'F'</span>, <span class="st">'M'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  last_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">28772</span>, <span class="fl">18028</span>, <span class="fl">11636</span>, <span class="fl">14589</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## Load genotype file</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gaston</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># geno = read.bed.matrix('data/geno_test')</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## Make a PGRM instance, specifying genome build and ancestry</span></span></span>
<span class="r-in"><span>  <span class="va">PGRM</span> <span class="op">=</span> <span class="fu"><a href="get_PGRM.html">get_PGRM</a></span><span class="op">(</span>build <span class="op">=</span> <span class="st">'hg19'</span>, ancestry <span class="op">=</span> <span class="st">'all'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## Run associations from the PGRM</span></span></span>
<span class="r-in"><span> <span class="co">#run_PGRM_assoc(geno,pheno,covars,covariate_names=c('last_age'),PGRM,MCC=2,use_exclude_range=TRUE,check_sex=TRUE)</span></span></span>
<span class="r-in"><span>  </span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Lisa Bastarache, Jake Hughey.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

