[{"path":"https://pgrm.hugheylab.org/articles/my-vignette.html","id":"load-packages","dir":"Articles","previous_headings":"","what":"Load packages","title":"Running the PGRM on summary statistics","text":"","code":"library('pgrm') library('data.table')"},{"path":"https://pgrm.hugheylab.org/articles/my-vignette.html","id":"load-gwas-summary-statistics-for-test-cohort","dir":"Articles","previous_headings":"","what":"Load GWAS summary statistics for test cohort","title":"Running the PGRM on summary statistics","text":"first step load file summary statistics. file must include columns SNP, phecode, cases, controls, odds ratios, P-values. 95% confidence intervals optional recommended. SNPs must denoted string chromosome, position, reference alternate allele, separated “:”. Builds hg19 hg37 supported. Odds ratios 95% upper/lower confidence invervals (U95, L95) oriented reference allele. example , open csv file containing summary statistics (case, summary statistics BioVU cohort) using fread() function. Alternatively can read datafile data.frame convert data.table using function data.table().","code":"d=fread(    system.file('extdata', 'data_sample.csv', package = 'pgrm'),    colClasses = list(character = 'phecode')) head(d) #>             SNP phecode cases controls odds_ratio            P       L95 #> 1: 1:894573:G:A     157   727    53432  0.9010491 0.2277126520 0.7607171 #> 2: 2:422144:T:C   250.2 11263    40224  0.9625318 0.3089630031 0.8942630 #> 3: 2:653575:C:T   250.2 11263    40224  0.9299909 0.0005285958 0.8925921 #> 4: 4:744972:G:T   250.2 11263    40224  1.0732594 0.0789713391 0.9918522 #> 5: 4:858332:C:T     332   679    46106  1.2214965 0.0218357270 1.0295019 #> 6: 4:939087:C:T     332   679    46106  1.2407473 0.0002761054 1.1045725 #>          U95 #> 1: 1.0672685 #> 2: 1.0360124 #> 3: 0.9689566 #> 4: 1.1613483 #> 5: 1.4492968 #> 6: 1.3937101"},{"path":"https://pgrm.hugheylab.org/articles/my-vignette.html","id":"annotate-test-chort-summary-statistics","dir":"Articles","previous_headings":"","what":"Annotate test chort summary statistics","title":"Running the PGRM on summary statistics","text":"Next, can add annotations PGRM test cohort results annotate_results() function. Use build argument specify build SNP labels (hg19 hg38). ancestry argument set genetic ancestry cohort (EAS, EUR, AFR, SAS, AMR, ). annotate_results() funciton annotate SNP/phenotype pairs present summary statistics table PGRM, returns data.table annotated summary statistics. annotation includes information power, replication, source study association. boolean variable powered indicates association powered 80% (given reported odds ratio allele frequency, along case control counts test cohort). boolean variable rep indicates association replicated test cohort p<0.05 direction effect consistent source test summary statistics. match direction effect, odds ratios test cohort must oriented alternate allle. data orginalized way, functionality can suppressed opion use_allele_dir==FALSE.","code":"anno = annotate_results(d, ancestry = 'EUR', build = 'hg19', calculate_power = TRUE, LOUD = FALSE) head(anno) #>    assoc_ID              SNP phecode cases controls odds_ratio            P #> 1:    29441 10:100702737:G:A     340  3385    47361  0.9940978 8.983416e-01 #> 2:     6712 10:101283330:C:A     244  9059    47425  0.9603257 1.625522e-02 #> 3:    21791 10:101284237:T:G     555  2440    31734  0.8681993 2.756970e-06 #> 4:   252232 10:101284237:T:G   555.1  2028    31734  0.8640033 9.246056e-06 #> 5:   304319 10:101284237:T:G   555.2  1156    31734  0.8843484 3.918215e-03 #> 6:   284865 10:101287764:G:A   555.1  2028    31734  0.8643269 9.639947e-06 #>          L95       U95 ancestry       rsID risk_allele_dir    RAF #> 1: 0.9077962 1.0886039      EUR rs12260159             ref 0.9200 #> 2: 0.9291361 0.9925622      EUR rs10748781             ref 0.4208 #> 3: 0.8183860 0.9210447      EUR  rs4409764             ref 0.4780 #> 4: 0.8099419 0.9216732      EUR  rs4409764             ref 0.4780 #> 5: 0.8134992 0.9613679      EUR  rs4409764             ref 0.4780 #> 6: 0.8102731 0.9219866      EUR rs10883365             ref 0.4797 #>                phecode_string category_string cat_LOG10_P   cat_OR cat_L95 #> 1:                   Migraine    neurological    9.522879 1.086957   1.060 #> 2:             Hypothyroidism       endocrine   10.000000 1.088000   1.060 #> 3: Inflammatory bowel disease       digestive   54.000000 1.182000   1.149 #> 4:         Regional enteritis       digestive   46.221849 1.188958   1.170 #> 5:         Ulcerative colitis       digestive   35.698970 1.171065   1.150 #> 6:         Regional enteritis       digestive    9.397940 1.180000   1.050 #>    cat_U95 Study_accession pub_count   pub_date powered rep     Power      rOR #> 1:   1.120      GCST003720         1 2016-06-20       0   0 0.2360927 1.005937 #> 2:   1.116      GCST003988         1 2016-05-16       1   1 0.9446085 1.041313 #> 3:   1.217      GCST001725         1 2012-11-01       1   1 0.9966647 1.151809 #> 4:   1.210      GCST003044         2 2015-07-20       1   1 0.9980411 1.157403 #> 5:   1.200      GCST003045         1 2015-07-20       1   1 0.9098123 1.130776 #> 6:   1.320      GCST000039         1 2007-06-06       0   1 0.3249896 1.156970 #>         rL95     rU95 CI_overlap #> 1: 0.9186078 1.101569    overlap #> 2: 1.0074935 1.076269    overlap #> 3: 1.0857236 1.221917    overlap #> 4: 1.0849833 1.234656    overlap #> 5: 1.0401845 1.229257    overlap #> 6: 1.0846145 1.234152    overlap"},{"path":"https://pgrm.hugheylab.org/articles/my-vignette.html","id":"calculate-the-replication-rate-of-associations-powered-at-80","dir":"Articles","previous_headings":"","what":"Calculate the replication rate of associations powered at >80%","title":"Running the PGRM on summary statistics","text":"get_RR function takes annotated data.table calcuated powered replication rate.","code":"get_RR(anno) #> Replicated 651 of 853 for RR=76.3% #> [1] 0.7631887"},{"path":"https://pgrm.hugheylab.org/articles/my-vignette.html","id":"calculate-the-overall-replication-rate","dir":"Articles","previous_headings":"","what":"Calculate the overall replication rate","title":"Running the PGRM on summary statistics","text":"adding include=‘’ option, replication rate calculated using associations, regardless power. measure known overall replication rate.","code":"get_RR(anno,include='all') #> Replicated 1354 of 3268 for RR=41.4% #> [1] 0.4143207"},{"path":"https://pgrm.hugheylab.org/articles/my-vignette.html","id":"calculate-the-actualexpected-ratio","dir":"Articles","previous_headings":"","what":"Calculate the actual:expected ratio","title":"Running the PGRM on summary statistics","text":"actual:expected ratio (AER) measure number associations replicated divided sum power. measure avoids threshold effect induced excluding power >80%, can particularly useful smaller datasets.","code":"get_AER(anno, LOUD = TRUE) #> Expected 1676.7, replicated 1354 for AE=0.808 (3268 associations for 106 uniq phecodes) #> [1] 0.8075431"},{"path":"https://pgrm.hugheylab.org/articles/my-vignette.html","id":"replication-by-phenotype-category","dir":"Articles","previous_headings":"","what":"Replication by phenotype category","title":"Running the PGRM on summary statistics","text":"can assess replication rate category like . make plot?","code":"by_pheno_cat=anno[,.(total_tested = .N, replicated = sum(rep), AER = sum(rep) / sum(Power)),                   by=c('category_string')] by_pheno_cat #>         category_string total_tested replicated       AER #>  1:        neurological          234        103 0.8595045 #>  2:           endocrine          330        198 0.8737966 #>  3:           digestive          517        241 0.9160612 #>  4:           neoplasms          669        289 0.8912240 #>  5:         respiratory          292         92 0.5983357 #>  6:  circulatory system          402        199 0.8818822 #>  7:         psychiatric          331         24 0.4104517 #>  8:        sense organs          188         59 0.6048072 #>  9:      metabolic/heme           33         23 0.7728091 #> 10:        dermatologic          138         79 0.7380070 #> 11:     musculoskeletal           75         23 0.6221231 #> 12:       genitourinary           48         21 0.6895891 #> 13: infectious diseases           11          3 0.9277110 library(ggplot2) ggplot(by_pheno_cat, aes(y = category_string, x = AER)) + geom_bar(stat = 'identity') +    theme_classic() + ylab('')"},{"path":"https://pgrm.hugheylab.org/articles/my-vignette.html","id":"comparing-a-single-phenotype","dir":"Articles","previous_headings":"","what":"Comparing a single phenotype","title":"Running the PGRM on summary statistics","text":"can also compare associations single phenotype reported catalog. , use rOR, rL95, rU95 values annotion file columns oriented risk allele. make plot, bind results test cohort source cohort (catalog) single phenotype.","code":"gout_test = anno[phecode_string %like% 'Gout',c('SNP', 'rOR', 'rL95', 'rU95')] gout_test$cohort = 'test' gout_cat = anno[phecode_string %like% 'Gout', c('SNP', 'cat_OR', 'cat_L95', 'cat_U95')] gout_cat$cohort = 'catalog' gout = rbind(gout_test, gout_cat, use.names = FALSE)  ggplot(gout, aes(y = SNP, x = rOR, color = cohort)) +    geom_point(position = position_dodge(width = 0.4)) +    geom_errorbar(aes(xmin = rL95, xmax = rU95), width = 0.2, position = position_dodge(width = 0.4)) +    ylab('') + xlab('Odds ratio') + theme_bw()"},{"path":"https://pgrm.hugheylab.org/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Lisa Bastarache. Author, maintainer. Jake Hughey. Author.","code":""},{"path":"https://pgrm.hugheylab.org/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Bastarache L, Hughey J (2022). pgrm: title stuff . https://pgrm.hugheylab.org, https://github.com/hugheylab/pgrm.","code":"@Manual{,   title = {pgrm: title stuff here},   author = {Lisa Bastarache and Jake Hughey},   year = {2022},   note = {https://pgrm.hugheylab.org, https://github.com/hugheylab/pgrm}, }"},{"path":"https://pgrm.hugheylab.org/index.html","id":"pgrm","dir":"","previous_headings":"","what":"title stuff here","title":"title stuff here","text":"pgrm R package measuring quality biobank data replication.","code":""},{"path":"https://pgrm.hugheylab.org/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"title stuff here","text":"","code":"if (!requireNamespace('remotes', quietly = TRUE))   install.packages('remotes') remotes::install_github('hugheylab/pgrm')"},{"path":"https://pgrm.hugheylab.org/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"title stuff here","text":"Check reference documentation.","code":""},{"path":"https://pgrm.hugheylab.org/reference/PGRM_ALL.html","id":null,"dir":"Reference","previous_headings":"","what":"The phenotype genotype referene map (PGRM) — PGRM_ALL","title":"The phenotype genotype referene map (PGRM) — PGRM_ALL","text":"table provides GWAS associations results GWAS catalog, annotated phecodes, ancestry, etc.","code":""},{"path":"https://pgrm.hugheylab.org/reference/PGRM_ALL.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The phenotype genotype referene map (PGRM) — PGRM_ALL","text":"","code":"PGRM_ALL"},{"path":"https://pgrm.hugheylab.org/reference/PGRM_ALL.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"The phenotype genotype referene map (PGRM) — PGRM_ALL","text":"data.table following columns: assoc_ID: Integer vector unique identifier association SNP_hg19: Character vector variants encoded hg19 genome reference build SNP_hg38: Character vector variants encoded hg38 genome reference build rsID: Character indicating Reference SNP cluster ID risk_allele_dir: Character vector specifying risk allele direction (alt: Alternate allele, ref: Reference allele) risk_allele: Character specifying risk allele phecode: Character vector phecode association phecode_string: Character vector phecode string label category_string: Character vector phecode category ancestry: Character vector ancestery source GWAS using 1000 Genomes superpopulations ancestry groupings (AFR: African, EAS: East Asian, EUR: European, AMR: AdMixed American, SAS: South Asian) cat_LOG10_P: Numeric vector -log10(P) association catalog cat_OR: Numeric value odds ratio association cat_L95: Numeric value 95% lower confidence interval association cat_U95: Numeric value 95% upper confidence interval association Study_accession: Character vector study accession ID GWAS catalog pubmedid: Numeric value PubMed ID source publication association pub_count: Numeric value indicating many times association published GWAS catalog first_pub_date: Date first date association published AFR_RAF: Numeric value African ancestry risk allele frequency gnomAD EUR_RAF: Numeric value European (non-Finnish) ancestry risk allele frequency gnomAD EAS_RAF: Numeric value East Asian ancestry risk allele frequency gnomAD AMR_RAF: Numeric value Latino/Admixed American ancestry risk allele frequency gnomAD SAS_RAF: Numeric value South Asian ancestry risk allele frequency gnomAD ALL_RAF: Numeric value risk allele frequency gnomAD","code":""},{"path":"https://pgrm.hugheylab.org/reference/PGRM_ALL.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"The phenotype genotype referene map (PGRM) — PGRM_ALL","text":"Allele frequencies: https://gnomad.broadinstitute.org/ Summary statistics: https://www.ebi.ac.uk/gwas/","code":""},{"path":"https://pgrm.hugheylab.org/reference/PGRM_ALL.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The phenotype genotype referene map (PGRM) — PGRM_ALL","text":"odds ratio 95% confidence intervals (columns cat_OR, cat_L95, cat_U95) reported relative risk allele specified column risk_allele.","code":""},{"path":[]},{"path":"https://pgrm.hugheylab.org/reference/annotate_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotate a result set with the PGRM — annotate_results","title":"Annotate a result set with the PGRM — annotate_results","text":"function annotates result test cohort information PGRM","code":""},{"path":"https://pgrm.hugheylab.org/reference/annotate_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotate a result set with the PGRM — annotate_results","text":"","code":"annotate_results(   results,   use_allele_dir = TRUE,   ancestry = \"all\",   build = \"hg19\",   phecode_version = \"V1.2\",   calculate_power = TRUE,   annotate_CI_overlap = TRUE,   LOUD = TRUE )"},{"path":"https://pgrm.hugheylab.org/reference/annotate_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotate a result set with the PGRM — annotate_results","text":"results data frame (data.table) results test cohort; columns SNP, phecode, cases, controls, odds_ratio, P (see demo files example (e.g results_MGI)) use_allele_dir TRUE, direction effect used assessing association replicated. use argument, odds ratios must reported alternative allele ancestry string specifies ancestry PGRM used annotate results file. Options EAS, EUR, AFR, SAS, AMR, . Default build string indicating genome reference build used results table. Options hg19, hg38. Default hg19. phecode_version string indicating phecode version used results table. (Currently V1.2 supported) calculate_power TRUE power calculations conducted using case control counts results file. Necessary get_AER(). Default FALSE annotate_CI_overlap TRUE column called 'annotate_CI_overlap' added table, values: overlap: 95% CIs PGRM test cohort overlap test_cohort_greater: 95% CI test cohort greater PGRM PGRM_greater: 95% CI PGRM greater test cohort annotate_CI_overlap TRUE, results must include 95% CIs LOUD TRUE progress info printed terminal. Default FALSE","code":""},{"path":"https://pgrm.hugheylab.org/reference/annotate_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Annotate a result set with the PGRM — annotate_results","text":"data.table results file annotated columsn PGRM","code":""},{"path":"https://pgrm.hugheylab.org/reference/annotate_results.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Annotate a result set with the PGRM — annotate_results","text":"function takes dataframe summary statistics test cohort. example way format results data frame, see one results sets included package (e.g. results_MGI). (NOTE: direction effect used determine association replicated, odds ratios result set must oriented alternative allele.) function returns data.table following annotations: Phecode informtion, including phecode_string phecode_category Risk allele frequency GnomAD (column RAF), ancestry specified ancestry argument rsID direction effect (ref alt) risk allele original association Summary statistics GWAS catalog association, including -log10(P), odds ratio, 95% confidence intervals (cat_LOG10_P, cat_OR, cat_L95, cat_U95) study accession ID GWAS catalog column called powered, 1 0 indicating whether test association powered > 80%. calculate_power==TRUE, power determined case/control counts specified results data.table. Otherwise, derrived estimate pre-computed cases needed assuming 1:5 case:control ratio. power calculations use alpha=0.0 column called rep indicates association replicated (.e. p<0.05 test cohort; use_allele_dir==TRUE, direction effect test cohort must also consistant reported catalog) annotate_CI_overlap true, information relationship 95% CIs catalog test set included column CI_overlap, new columns odds_ratio, L95, U95 created(rOR, rL95, rU95) oriented risk allele. (option requires confidence intervals reported test cohort summary statistics)","code":""},{"path":[]},{"path":"https://pgrm.hugheylab.org/reference/annotate_results.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Annotate a result set with the PGRM — annotate_results","text":"","code":"library(pgrm)  ## annotate the BioVU African ancestry result set anno = annotate_results(results_BioVU_AFR, ancestry = 'AFR', build = 'hg19', calculate_power = TRUE) #> [1] \"Doing power calculations\"  ## Get the replication rate of associations powered at >80% get_RR(anno) #> Replicated 11 of 14 for RR=78.6% #> [1] 0.7857143  ## Get the replication rate of all associations get_RR(anno,include='all') #> Replicated 19 of 31 for RR=61.3% #> [1] 0.6129032  ## Get the actual:expected ratio get_AER(anno) #> Expected 20.2, replicated 19 for AE=0.94 (31 associations for 14 uniq phecodes) #> [1] 0.9402914"},{"path":"https://pgrm.hugheylab.org/reference/benchmark_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary statistics from all five test cohorts with annotations — benchmark_results","title":"Summary statistics from all five test cohorts with annotations — benchmark_results","text":"table summary statistics PGRM association BioVU (EUR AFR), BBJ, MGI, UKBB. associations annotated table long format.","code":""},{"path":"https://pgrm.hugheylab.org/reference/benchmark_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary statistics from all five test cohorts with annotations — benchmark_results","text":"","code":"benchmark_results"},{"path":"https://pgrm.hugheylab.org/reference/benchmark_results.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Summary statistics from all five test cohorts with annotations — benchmark_results","text":"data.table following columns: assoc_ID: Integer vector unique identifier association phecode: Character vector phecode association phecode_string: Character vector phecode string label category_string: Character vector phecode category cases: Integer number cases specified phecode/cohort controls: Integer number controls specified phecode/cohort odds_ratio: Numeric odds ratio test cohort association P: Numeric raw P-value test cohort association L95: Numeric 95% lower confidence interval test cohort association U95: Numeric 95% upper confidence interval test cohort association cohort: Character vector source cohort (BBJ: Biobank Japan, BioVU_AFR: BioVU, African ancestry, BioVU_EUR: BioVU, European ancestry, MGI: Michigan genomics initiative, UKBB: UK Biobank) ancestry: Character vector ancestery source GWAS using 1000 Genomes superpopulations ancestry groupings (AFR: African, EAS: East Asian, EUR: European, AMR: AdMixed American, SAS: South Asian) rsID: Character indicating Reference SNP cluster ID risk_allele_dir: Character indicating specifying risk allele direction (alt: Alternate allele, ref: Reference allele) RAF: GnomAD frequency risk allele, matched ancestry cat_LOG10_P: Numeric vector -log10(P) association catalog cat_OR: Numeric vector odds ratio association cat_L95: Numeric vector 95% lower confidence interval association cat_U95: Numeric vector 95% upper confidence interval association Study_accession: Character vector study accession ID GWAS catalog Powered: Boolean value indicating association powered >=80% rep: Boolean value indicating association replicated CI_overlap: Character vector indicating overlap confidence intervals catalog test association CI_overlap: Character vector indicating test cohort pub_count: number times association reported catalog first_pub_date: first date association published","code":""},{"path":"https://pgrm.hugheylab.org/reference/exclude_ranges.html","id":null,"dir":"Reference","previous_headings":"","what":"Exclude ranges for phecode controls — exclude_ranges","title":"Exclude ranges for phecode controls — exclude_ranges","text":"Exclude ranges phecode controls","code":""},{"path":"https://pgrm.hugheylab.org/reference/exclude_ranges.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Exclude ranges for phecode controls — exclude_ranges","text":"","code":"exclude_ranges"},{"path":"https://pgrm.hugheylab.org/reference/exclude_ranges.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Exclude ranges for phecode controls — exclude_ranges","text":"data table following columns: phecode: Character vector phecode range_start: Numeric vector start exclude range range_end: Numeric vector end exclude range","code":""},{"path":"https://pgrm.hugheylab.org/reference/exclude_ranges.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Exclude ranges for phecode controls — exclude_ranges","text":"https://phewascatalog.org","code":""},{"path":[]},{"path":"https://pgrm.hugheylab.org/reference/get_AER.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the acual:expected ratio (A:E) of a test cohort — get_AER","title":"Calculate the acual:expected ratio (A:E) of a test cohort — get_AER","text":"function calculates actual:expected test cohort annotated PGRM.","code":""},{"path":"https://pgrm.hugheylab.org/reference/get_AER.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the acual:expected ratio (A:E) of a test cohort — get_AER","text":"","code":"get_AER(annotated_results, LOUD = TRUE)"},{"path":"https://pgrm.hugheylab.org/reference/get_AER.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the acual:expected ratio (A:E) of a test cohort — get_AER","text":"annotated_results data table results annotated PGRM LOUD TRUE progress info printed terminal. Default TRUE","code":""},{"path":"https://pgrm.hugheylab.org/reference/get_AER.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the acual:expected ratio (A:E) of a test cohort — get_AER","text":"numeric value actual:expected ratio result set","code":""},{"path":"https://pgrm.hugheylab.org/reference/get_PGRM.html","id":null,"dir":"Reference","previous_headings":"","what":"Get instance of PGRM — get_PGRM","title":"Get instance of PGRM — get_PGRM","text":"function generates PGRM copy specified ancestry, build, phecode version","code":""},{"path":"https://pgrm.hugheylab.org/reference/get_PGRM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get instance of PGRM — get_PGRM","text":"","code":"get_PGRM(   ancestry = \"all\",   build = \"hg19\",   phecode_version = \"V1.2\",   unique = TRUE )"},{"path":"https://pgrm.hugheylab.org/reference/get_PGRM.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get instance of PGRM — get_PGRM","text":"ancestry string indicates ancestry PGRM. Options EAS, EUR, AFR, SAS, AMR, . Default build string indicating genome reference build. Options hg19, hg38. Default hg19. phecode_version string indicating phecode version. Currently V1.2 supported, default unique TRUE, rows uniqued SNP/phecode (relevant ancestry == '')","code":""},{"path":"https://pgrm.hugheylab.org/reference/get_PGRM.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get instance of PGRM — get_PGRM","text":"data.table PGRM","code":""},{"path":"https://pgrm.hugheylab.org/reference/get_PGRM.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get instance of PGRM — get_PGRM","text":"function returns copy PGRM. function assigns column 'SNP' either SNP_hg19 SNP_hg38, depending build argument. returned PGRM includes associations annotated specified ancestry, risk allele frequency (RAF) based specified ancestry.","code":""},{"path":[]},{"path":"https://pgrm.hugheylab.org/reference/get_PGRM.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get instance of PGRM — get_PGRM","text":"","code":"library(pgrm)  ## Get a copy of the PGRM for build hg19, East Asian ancestry get_PGRM(build = 'hg19', ancestry = 'EAS') #>       assoc_ID             SNP ancestry        rsID risk_allele_dir        RAF #>    1:     7883 4:174444902:G:A      EAS  rs17059534             alt 0.07270002 #>    2:     7884 4:111718067:G:A      EAS   rs6843082             ref 0.75449997 #>    3:     7885 4:111761487:T:C      EAS   rs3853445             ref 0.63690001 #>    4:     7886 1:112392360:G:T      EAS  rs12044963             alt 0.34810001 #>    5:     7887 1:203026591:A:G      EAS  rs17461925             ref 0.80930001 #>   ---                                                                          #> 1211:   306221  6:32575513:C:G      EAS   rs9271060             alt 0.81039999 #> 1212:   306222  6:83648056:C:T      EAS    rs293526             alt 0.79761900 #> 1213:   306223 9:117568766:A:G      EAS   rs6478109             alt 0.47939998 #> 1214:   306224  6:32659443:A:C      EAS rs140068907             alt 0.06639999 #> 1215:   311954  18:6282593:A:C      EAS    rs403814             ref 0.75610000 #>       phecode      phecode_string    category_string cat_LOG10_P   cat_OR #>    1:  427.21 Atrial fibrillation circulatory system    9.522879 1.201000 #>    2:  427.21 Atrial fibrillation circulatory system  126.000000 1.842000 #>    3:  427.21 Atrial fibrillation circulatory system   33.698970 1.330000 #>    4:  427.21 Atrial fibrillation circulatory system   14.397940 1.110000 #>    5:  427.21 Atrial fibrillation circulatory system   10.045757 1.077000 #>   ---                                                                     #> 1211:   555.1  Regional enteritis          digestive   22.000000 2.857143 #> 1212:   555.1  Regional enteritis          digestive   10.698970 2.127660 #> 1213:   555.1  Regional enteritis          digestive   24.301030 2.083334 #> 1214:   555.1  Regional enteritis          digestive   11.000000 1.980000 #> 1215:     401        Hypertension circulatory system    8.221849 1.150000 #>       cat_L95 cat_U95 Study_accession pub_count   pub_date #>    1:   1.134   1.271      GCST004373         1 2017-04-17 #>    2:   1.751   1.939      GCST004373         1 2017-04-17 #>    3:   1.271   1.391      GCST004373         1 2017-04-17 #>    4:   1.082   1.140      GCST004373         2 2017-04-17 #>    5:   1.053   1.102      GCST004373         1 2017-04-17 #>   ---                                                      #> 1211:   2.330   3.570      GCST003360         1 2016-02-18 #> 1212:   1.690   2.630      GCST003360         1 2016-02-18 #> 1213:   1.820   2.380      GCST003360         1 2016-02-18 #> 1214:   1.620   2.410      GCST003360         1 2016-02-18 #> 1215:   1.070   1.230      GCST003613         1 2016-08-02"},{"path":"https://pgrm.hugheylab.org/reference/get_RR.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the replicaiton rate (RR) of a test cohort — get_RR","title":"Calculate the replicaiton rate (RR) of a test cohort — get_RR","text":"function calculates replicaiton rate test cohort annotated PGRM. default, calculates RR associations powered >80%.","code":""},{"path":"https://pgrm.hugheylab.org/reference/get_RR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the replicaiton rate (RR) of a test cohort — get_RR","text":"","code":"get_RR(annotated_results, include = \"powered\", LOUD = TRUE)"},{"path":"https://pgrm.hugheylab.org/reference/get_RR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the replicaiton rate (RR) of a test cohort — get_RR","text":"annotated_results data table results annotated PGRM include character string. 'powered' powered associations included. '' associations included LOUD TRUE progress info printed terminal. Default TRUE","code":""},{"path":"https://pgrm.hugheylab.org/reference/get_RR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the replicaiton rate (RR) of a test cohort — get_RR","text":"numeric value replication rate result set","code":""},{"path":"https://pgrm.hugheylab.org/reference/get_RR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the replicaiton rate (RR) of a test cohort — get_RR","text":"","code":"library(pgrm)   library(data.table)    ## Read in an ICD file. Format should look like the example file.   ## Note: Don't forget to load icd column as a character vector!   head(icdExampleTable) #>    person_id    icd flag entry_date #> 1:         1  034.0    9 2014-04-12 #> 2:         3  041.9    9 2014-08-06 #> 3:         1 079.99    9 2011-05-30 #> 4:         3  112.1    9 2014-08-06 #> 5:         2  150.5    9 2014-02-17 #> 6:         2  150.5    9 2014-04-18    ## make pheno table   pheno = make_pheno(icdExampleTable)   head(pheno) #>    person_id phecode N #> 1:         1     465 5 #> 2:         3     041 2 #> 3:         1     079 2 #> 4:         3     112 1 #> 5:         2     150 3 #> 6:         2     151 6    ## Load in covariate file. Here's a generated example   covar_table_test = data.table(   person_id = 1:4, sex = c('F', 'M', 'F', 'M'),   last_age = c(28772, 18028, 11636, 14589))    ## Load genotype file   library(gaston) #> Loading required package: Rcpp #> Loading required package: RcppParallel #>  #> Attaching package: ‘RcppParallel’ #> The following object is masked from ‘package:Rcpp’: #>  #>     LdFlags #> Gaston set number of threads to 1. Use setThreadOptions() to modify this. #>  #> Attaching package: ‘gaston’ #> The following object is masked from ‘package:stats’: #>  #>     sigma #> The following objects are masked from ‘package:base’: #>  #>     cbind, rbind  # geno = read.bed.matrix('data/geno_test')    ## Make a PGRM instance, specifying genome build and ancestry   PGRM = get_PGRM(build = 'hg19', ancestry = 'all')    ## Run associations from the PGRM   run_PGRM_assoc(geno,pheno,covars,covariate_names=c('last_age'),PGRM,MCC=2,use_exclude_range=TRUE,check_sex=TRUE) #> Error in checkMultiClass(x, classes, null.ok): object 'geno' not found"},{"path":"https://pgrm.hugheylab.org/reference/get_pheno.html","id":null,"dir":"Reference","previous_headings":"","what":"Add case/control status for a specified phenotype to a covariate file. — get_pheno","title":"Add case/control status for a specified phenotype to a covariate file. — get_pheno","text":"Add case/control status specified phenotype covariate file.","code":""},{"path":"https://pgrm.hugheylab.org/reference/get_pheno.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add case/control status for a specified phenotype to a covariate file. — get_pheno","text":"","code":"get_pheno(   pheno,   covars,   phecode,   MCC = 2,   use_exclude_ranges = TRUE,   check_sex = FALSE )"},{"path":"https://pgrm.hugheylab.org/reference/get_pheno.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add case/control status for a specified phenotype to a covariate file. — get_pheno","text":"pheno data.table phecode phenotypes. columns person_id, phecode, N required. phecode columns character vector. Column N specifies number unique dates phecode occurs individual. phecodes present individual included (.e. N always greater one). covars data.table one row per person cohort. Must havea column names person_id. Must include columns specified covariate_names. phecode character vector phecode MCC numeric value specified minimum code count required cases. use_exclude_ranges TRUE individuals cases phecode within exclude ranges excluded. check_sex TRUE pheno column set zero individuals sex match specified sex. argument relevant sex specific codes (e.g. Prostate cancer). use function, sex must included column covars data.table.","code":""},{"path":"https://pgrm.hugheylab.org/reference/get_pheno.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add case/control status for a specified phenotype to a covariate file. — get_pheno","text":"covar data.table new column called pheno. column 0 individual, control specified phecode, 1 case, NA excluded.","code":""},{"path":"https://pgrm.hugheylab.org/reference/get_powered_rate.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the percent of associations that are powered in a test set — get_powered_rate","title":"Calculate the percent of associations that are powered in a test set — get_powered_rate","text":"function calculates % powered associations test cohort annotated PGRM.","code":""},{"path":"https://pgrm.hugheylab.org/reference/get_powered_rate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the percent of associations that are powered in a test set — get_powered_rate","text":"","code":"get_powered_rate(annotated_results, include_missing_pheno = TRUE, LOUD = TRUE)"},{"path":"https://pgrm.hugheylab.org/reference/get_powered_rate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the percent of associations that are powered in a test set — get_powered_rate","text":"annotated_results data table results annotated PGRM include_missing_pheno TRUE, denominator inclues SNP/phecode pairs present annotated_results data.table LOUD TRUE progress info printed terminal. Default TRUE","code":""},{"path":"https://pgrm.hugheylab.org/reference/get_powered_rate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the percent of associations that are powered in a test set — get_powered_rate","text":"numeric value percent associations powered","code":""},{"path":"https://pgrm.hugheylab.org/reference/icdExampleTable.html","id":null,"dir":"Reference","previous_headings":"","what":"Example table of ICD data — icdExampleTable","title":"Example table of ICD data — icdExampleTable","text":"Example table ICD data","code":""},{"path":"https://pgrm.hugheylab.org/reference/icdExampleTable.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example table of ICD data — icdExampleTable","text":"","code":"icdExampleTable"},{"path":"https://pgrm.hugheylab.org/reference/icdExampleTable.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example table of ICD data — icdExampleTable","text":"data.table following columns: person_id: unqiue identifier subject icd: Character vector icd code flag: Integer ICD version (either 9 10) entry_date: Date ICD code","code":""},{"path":"https://pgrm.hugheylab.org/reference/icdPhecodeMap_V1_2.html","id":null,"dir":"Reference","previous_headings":"","what":"ICD code to phecode map, version 1.2 — icdPhecodeMap_V1_2","title":"ICD code to phecode map, version 1.2 — icdPhecodeMap_V1_2","text":"map used make_pheno() function","code":""},{"path":"https://pgrm.hugheylab.org/reference/icdPhecodeMap_V1_2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ICD code to phecode map, version 1.2 — icdPhecodeMap_V1_2","text":"","code":"icdPhecodeMap_V1_2"},{"path":"https://pgrm.hugheylab.org/reference/icdPhecodeMap_V1_2.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"ICD code to phecode map, version 1.2 — icdPhecodeMap_V1_2","text":"data.table following columns: icd: Character vector icd code. flag: Integer ICD version (either 9 10) phecode: Character vector phecode","code":""},{"path":"https://pgrm.hugheylab.org/reference/make_pheno.html","id":null,"dir":"Reference","previous_headings":"","what":"Make a phecode phenotype file from table of ICD codes — make_pheno","title":"Make a phecode phenotype file from table of ICD codes — make_pheno","text":"function calculates % powered associations test cohort annotated PGRM.","code":""},{"path":"https://pgrm.hugheylab.org/reference/make_pheno.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make a phecode phenotype file from table of ICD codes — make_pheno","text":"","code":"make_pheno(icds, phecode_version = \"V1.2\")"},{"path":"https://pgrm.hugheylab.org/reference/make_pheno.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make a phecode phenotype file from table of ICD codes — make_pheno","text":"icds data table ICD codes. Must include columns person_id, icd, flag phecode_version Phecode map version. Currently supports 'V1.2', default","code":""},{"path":"https://pgrm.hugheylab.org/reference/make_pheno.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make a phecode phenotype file from table of ICD codes — make_pheno","text":"numeric value percent associations powered","code":""},{"path":"https://pgrm.hugheylab.org/reference/phecode_info.html","id":null,"dir":"Reference","previous_headings":"","what":"Information about phecodes — phecode_info","title":"Information about phecodes — phecode_info","text":"Information phecodes","code":""},{"path":"https://pgrm.hugheylab.org/reference/phecode_info.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Information about phecodes — phecode_info","text":"","code":"phecode_info"},{"path":"https://pgrm.hugheylab.org/reference/phecode_info.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Information about phecodes — phecode_info","text":"data table following columns: phecode: Character vector phecode phecode_string: Character vector string label phecode sex: Indicates phecode sex specific. Values Female, Male, leaf: boolean value indicating phecode leaf (children) phecode_top: Character vector parent phecode phecode_top: Character vector category label","code":""},{"path":"https://pgrm.hugheylab.org/reference/phecode_info.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Information about phecodes — phecode_info","text":"https://phewascatalog.org","code":""},{"path":[]},{"path":"https://pgrm.hugheylab.org/reference/results_BBJ.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary statistics from BioBank Japan (BBJ) — results_BBJ","title":"Summary statistics from BioBank Japan (BBJ) — results_BBJ","text":"table provides BBJ GWAS summary statistics SNPs phecodes PGRM","code":""},{"path":"https://pgrm.hugheylab.org/reference/results_BBJ.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary statistics from BioBank Japan (BBJ) — results_BBJ","text":"","code":"results_BBJ"},{"path":"https://pgrm.hugheylab.org/reference/results_BBJ.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Summary statistics from BioBank Japan (BBJ) — results_BBJ","text":"data.table following columns: SNP: String SNP identifier, format CHR:position:ref:alt. Build = hg19. phecode: String phecode cases: Integer number cases specified phecode controls: Integer number controls specified phecode odds_ratio: Numeric odds ratio P: Numeric raw P-value L95: Numeric 95% lower confidence interval U95: Numeric 95% upper confidence interval cohort_match: Integer 1 source PGRM association includes BBJ, 0 ","code":""},{"path":"https://pgrm.hugheylab.org/reference/results_BBJ.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Summary statistics from BioBank Japan (BBJ) — results_BBJ","text":"https://pheweb.jp","code":""},{"path":"https://pgrm.hugheylab.org/reference/results_BioVU_AFR.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary statistics from the African ancestery cohort in BioVU — results_BioVU_AFR","title":"Summary statistics from the African ancestery cohort in BioVU — results_BioVU_AFR","text":"table provides BioVU African ancestry GWAS summary statistics SNPs phecodes PGRM","code":""},{"path":"https://pgrm.hugheylab.org/reference/results_BioVU_AFR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary statistics from the African ancestery cohort in BioVU — results_BioVU_AFR","text":"","code":"results_BioVU_AFR"},{"path":"https://pgrm.hugheylab.org/reference/results_BioVU_AFR.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Summary statistics from the African ancestery cohort in BioVU — results_BioVU_AFR","text":"data.table following columns: SNP: String SNP identifier, format CHR:position:ref:alt. Build = hg19 phecode: String phecode cases: Integer number cases specified phecode controls: Integer number controls specified phecode odds_ratio: Numeric odds ratio P: Numeric raw P-value L95: Numeric 95% lower confidence interval U95: Numeric 95% upper confidence interval cohort_match: Integer 1 source PGRM association includes BioVU, 0 ","code":""},{"path":"https://pgrm.hugheylab.org/reference/results_BioVU_EUR.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary statistics from the European ancestery cohort in BioVU — results_BioVU_EUR","title":"Summary statistics from the European ancestery cohort in BioVU — results_BioVU_EUR","text":"table provides BioVU European ancestry GWAS summary statistics SNPs phecodes PGRM","code":""},{"path":"https://pgrm.hugheylab.org/reference/results_BioVU_EUR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary statistics from the European ancestery cohort in BioVU — results_BioVU_EUR","text":"","code":"results_BioVU_EUR"},{"path":"https://pgrm.hugheylab.org/reference/results_BioVU_EUR.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Summary statistics from the European ancestery cohort in BioVU — results_BioVU_EUR","text":"data.table following columns: SNP: String SNP identifier, format CHR:position:ref:alt. Build = hg19 phecode: String phecode cases: Integer number cases specified phecode controls: Integer number controls specified phecode odds_ratio: Numeric odds ratio P: Numeric raw P-value L95: Numeric 95% lower confidence interval U95: Numeric 95% upper confidence interval cohort_match: Integer 1 source PGRM association includes BioVU, 0 ","code":""},{"path":"https://pgrm.hugheylab.org/reference/results_MGI.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary statistics from the Michigan Genomics Initiative (MGI) — results_MGI","title":"Summary statistics from the Michigan Genomics Initiative (MGI) — results_MGI","text":"table provides MGI GWAS summary statistics SNPs phecodes PGRM","code":""},{"path":"https://pgrm.hugheylab.org/reference/results_MGI.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary statistics from the Michigan Genomics Initiative (MGI) — results_MGI","text":"","code":"results_MGI"},{"path":"https://pgrm.hugheylab.org/reference/results_MGI.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Summary statistics from the Michigan Genomics Initiative (MGI) — results_MGI","text":"data.table following columns: SNP: String SNP identifier, format CHR:position:ref:alt. Build = hg38 phecode: String phecode cases: Integer number cases specified phecode controls: Integer number controls specified phecode odds_ratio: Numeric odds ratio P: Numeric raw P-value L95: Numeric 95% lower confidence interval U95: Numeric 95% upper confidence interval cohort_match: Integer 1 source PGRM association includes MGI, 0 ","code":""},{"path":"https://pgrm.hugheylab.org/reference/results_UKBB.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary statistics from UK Biobank (UKBB) — results_UKBB","title":"Summary statistics from UK Biobank (UKBB) — results_UKBB","text":"table provides UK Biobank GWAS summary statistics SNPs phecodes PGRM","code":""},{"path":"https://pgrm.hugheylab.org/reference/results_UKBB.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary statistics from UK Biobank (UKBB) — results_UKBB","text":"","code":"results_UKBB"},{"path":"https://pgrm.hugheylab.org/reference/results_UKBB.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Summary statistics from UK Biobank (UKBB) — results_UKBB","text":"data.table following columns: SNP: String SNP identifier, format CHR:position:ref:alt. Build = hg38 phecode: String phecode cases: Integer number cases specified phecode controls: Integer number controls specified phecode odds_ratio: Numeric odds ratio P: Numeric raw P-value L95: Numeric 95% lower confidence interval U95: Numeric 95% upper confidence interval cohort_match: Integer 1 source PGRM association includes UKBB, 0 ","code":""},{"path":"https://pgrm.hugheylab.org/reference/results_UKBB.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Summary statistics from UK Biobank (UKBB) — results_UKBB","text":"https://pheweb.org/UKB-TOPMed/","code":""},{"path":"https://pgrm.hugheylab.org/reference/run_PGRM_assoc.html","id":null,"dir":"Reference","previous_headings":"","what":"Run associations in the pgrm on data from a test cohort. Function requires row level phenotype,\ngenotype, and covariate information. — run_PGRM_assoc","title":"Run associations in the pgrm on data from a test cohort. Function requires row level phenotype,\ngenotype, and covariate information. — run_PGRM_assoc","text":"(NOTE: used principle components covariates, make sure coded numeric. Otherwise logistic regression treat categorical variables, making function run slowly failing.)","code":""},{"path":"https://pgrm.hugheylab.org/reference/run_PGRM_assoc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run associations in the pgrm on data from a test cohort. Function requires row level phenotype,\ngenotype, and covariate information. — run_PGRM_assoc","text":"","code":"run_PGRM_assoc(   geno,   pheno,   covars,   covariate_names,   PGRM,   MCC = 2,   minimum_case_count = 100,   use_exclude_ranges = TRUE,   check_sex = FALSE,   LOUD = TRUE )"},{"path":"https://pgrm.hugheylab.org/reference/run_PGRM_assoc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run associations in the pgrm on data from a test cohort. Function requires row level phenotype,\ngenotype, and covariate information. — run_PGRM_assoc","text":"geno matrix 'BEDMatrix' object containing genetic data pheno data.table phecode phenotypes. columns person_id, phecode, N required. phecode columns character vector. Column N specifies number unique dates phecode occurs individual. phecodes present individual included (.e. N always greater one). covars data.table one row per person cohort. Must havea column names person_id. Must include columns specified covariate_names. covariate_names list covariates used logistic regression. covariates listed must present covars table PGRM data.table PGRM, generated get_PGRM() MCC integer specifying minimum code count required case (default MCC=2) minimum_case_count integer specifiying minimum number cases required test cohort included analysis (default minimum_case_count=100) use_exclude_ranges TRUE exclude ranges applied controls check_sex TRUE individuals sex == F covars table excluded male-specific phenotypes, vice-versa. Sex specific phecodes specified phecode_info. function work, covars table must column sex values must 'M' Male 'F' Female LOUD TRUE progress info printed terminal. Default TRUE","code":""},{"path":"https://pgrm.hugheylab.org/reference/run_PGRM_assoc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run associations in the pgrm on data from a test cohort. Function requires row level phenotype,\ngenotype, and covariate information. — run_PGRM_assoc","text":"data.table annotated results association tests","code":""},{"path":"https://pgrm.hugheylab.org/reference/run_PGRM_assoc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run associations in the pgrm on data from a test cohort. Function requires row level phenotype,\ngenotype, and covariate information. — run_PGRM_assoc","text":"","code":"library(pgrm)   library(data.table)    ## Read in an ICD file. Format should look like the example file.   ## Note: Don't forget to load icd column as a character vector!   head(icdExampleTable) #>    person_id    icd flag entry_date #> 1:         1  034.0    9 2014-04-12 #> 2:         3  041.9    9 2014-08-06 #> 3:         1 079.99    9 2011-05-30 #> 4:         3  112.1    9 2014-08-06 #> 5:         2  150.5    9 2014-02-17 #> 6:         2  150.5    9 2014-04-18    ## make pheno table   pheno = make_pheno(icdExampleTable)   head(pheno) #>    person_id phecode N #> 1:         1     465 5 #> 2:         3     041 2 #> 3:         1     079 2 #> 4:         3     112 1 #> 5:         2     150 3 #> 6:         2     151 6    ## Load in covariate file. Here's a generated example   covar_table_test = data.table(   person_id = 1:4, sex = c('F', 'M', 'F', 'M'),   last_age = c(28772, 18028, 11636, 14589))    ## Load genotype file   library(gaston)  # geno = read.bed.matrix('data/geno_test')    ## Make a PGRM instance, specifying genome build and ancestry   PGRM = get_PGRM(build = 'hg19', ancestry = 'all')    ## Run associations from the PGRM   run_PGRM_assoc(geno,pheno,covars,covariate_names=c('last_age'),PGRM,MCC=2,use_exclude_range=TRUE,check_sex=TRUE) #> Error in checkMultiClass(x, classes, null.ok): object 'geno' not found"},{"path":"https://pgrm.hugheylab.org/news/index.html","id":"pgrm-001","dir":"Changelog","previous_headings":"","what":"pgrm 0.0.1","title":"pgrm 0.0.1","text":"yet.","code":""}]
